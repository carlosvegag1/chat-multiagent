<head>
  <meta charset="utf-8">
  <title>Chat Multi-Agent Travel ‚Äî Docker Quickstart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      margin: 2rem auto;
      max-width: 900px;
      color: #0f172a;
      background-color: #f9fafb;
    }
    h1, h2, h3 {
      color: #1e293b;
      line-height: 1.25;
    }
    code, pre {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    }
    pre {
      background: #0f172a;
      color: #e2e8f0;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
    }
    a {
      color: #2563eb;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
    }
    th, td {
      padding: .6rem .8rem;
      border: 1px solid #cbd5e1;
    }
    th {
      background: #e2e8f0;
      text-align: left;
    }
    .ok { color: #16a34a; font-weight: 600; }
    .warn { color: #ca8a04; font-weight: 600; }
    .err { color: #dc2626; font-weight: 600; }
    hr {
      border: none;
      border-top: 2px solid #e2e8f0;
      margin: 2rem 0;
    }
    ul, ol {
      margin-left: 1.5rem;
    }
    footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.9rem;
      color: #475569;
    }
  </style>
</head>
<body>

<h1>üöÄ Chat Multi-Agent Travel</h1>
<p>
Proyecto listo para ejecutar con <strong>Docker</strong> o en local.  
Incluye un <strong>backend FastAPI</strong>, un <strong>frontend Next.js</strong> y 4 micro-servicios MCP (vuelos, hoteles, destinos y c√°lculo).
</p>

<hr>

<h2>üß© 1) Requisitos</h2>
<ul>
  <li>Windows / macOS / Linux con <a href="https://www.docker.com/products/docker-desktop" target="_blank">Docker Desktop</a>.</li>
  <li>(Opcional) Claves reales:
    <ul>
      <li><code>OPENAI_API_KEY</code></li>
      <li><code>AMADEUS_API_KEY</code></li>
      <li><code>AMADEUS_API_SECRET</code></li>
      <li><code>WEATHER_API_KEY</code></li>
    </ul>
  </li>
</ul>

<hr>

<h2>üîë 2) Configura tus claves (opcional pero recomendado)</h2>
<ol>
  <li>Copia <code>.env.example</code> a <code>.env</code> en la <strong>ra√≠z</strong> del proyecto.</li>
  <li>Rellena las variables que tengas:</li>
</ol>

<pre>OPENAI_API_KEY=sk-...
AMADEUS_API_KEY=...
AMADEUS_API_SECRET=...
WEATHER_API_KEY=...</pre>

<p>El archivo <code>docker-compose.yml</code> inyecta estas variables autom√°ticamente si existen, pero no son obligatorias para arrancar.</p>

<hr>

<h2>‚ö° 3) Arranque s√∫per r√°pido</h2>
<pre>docker compose up -d --build</pre>

<p><strong>Servicios expuestos:</strong></p>

<table>
  <thead>
    <tr><th>Servicio</th><th>URL</th></tr>
  </thead>
  <tbody>
    <tr><td>Frontend</td><td><a href="http://127.0.0.1:3000" target="_blank">http://127.0.0.1:3000</a></td></tr>
    <tr><td>Backend (Swagger)</td><td><a href="http://127.0.0.1:8000/docs" target="_blank">http://127.0.0.1:8000/docs</a></td></tr>
    <tr><td>Calc</td><td><a href="http://127.0.0.1:8770/docs" target="_blank">8770</a></td></tr>
    <tr><td>Flights</td><td><a href="http://127.0.0.1:8771/docs" target="_blank">8771</a></td></tr>
    <tr><td>Hotels</td><td><a href="http://127.0.0.1:8772/docs" target="_blank">8772</a></td></tr>
    <tr><td>Destinations</td><td><a href="http://127.0.0.1:8773/docs" target="_blank">8773</a></td></tr>
  </tbody>
</table>

<hr>

<h2>ü©∫ 4) Pruebas de salud</h2>
<p class="ok">Esperado: <code>HTTP/1.1 200 OK</code></p>
<pre>curl -I http://127.0.0.1:8770/docs
curl -I http://127.0.0.1:8771/docs
curl -I http://127.0.0.1:8772/docs
curl -I http://127.0.0.1:8773/docs
curl -I http://127.0.0.1:8000/docs
curl -I http://127.0.0.1:3000</pre>

<hr>

<h2>üí¨ 5) Probar el chat por API</h2>
<p>Ejemplo (PowerShell en Windows):</p>
<pre>$body = @{
  user     = "Demo"
  message  = "Quiero un viaje de 2 d√≠as a Palma de Mallorca"
  convo_id = ""
} | ConvertTo-Json

curl.exe -s -X POST "http://127.0.0.1:8000/chat/" `
  -H "Content-Type: application/json" `
  --data-raw $body
</pre>

<hr>

<h2>üìú 6) Ver logs</h2>
<p>√öltimas l√≠neas de todos los servicios:</p>
<pre>docker compose logs --tail=200</pre>

<p>Un servicio concreto:</p>
<pre>docker compose logs --tail=200 backend
docker compose logs --tail=200 flights
docker compose logs --tail=200 destinations
docker compose logs --tail=200 hotels
docker compose logs --tail=200 calc
docker compose logs --tail=200 frontend</pre>

<p>Seguimiento en vivo:</p>
<pre>docker compose logs -f backend</pre>

<p>Buscar errores comunes:</p>
<pre>docker compose logs backend | findstr /I "ERROR FALLBACK connect timeout refused"</pre>

<hr>

<h2>üß† 7) Problemas t√≠picos y soluci√≥n r√°pida</h2>

<ul>
  <li class="err">El backend intenta llamar a <code>127.0.0.1</code> desde Docker</li>
  <ul>
    <li>Este repo ya trae agentes con defaults a <code>flights:</code>, <code>destinations:</code> y <code>hotels:</code>.</li>
    <li>Comprueba en los logs del backend que aparezcan:<br>
    <code>DestinationAgent conectado a: http://destinations:8773</code><br>
    <code>FlightAgent conectado a: http://flights:8771</code></li>
  </ul>

  <li class="warn">Aviso: <code>WEATHER_API_KEY</code> no definida</li>
  <ul><li>Es opcional. Si quieres quitar el warning, a√±ade la clave en tu <code>.env</code>.</li></ul>
</ul>

<hr>

<h2>üßë‚Äçüíª 8) Desarrollo local (sin Docker)</h2>
<ol>
  <li>Levanta los MCPs individualmente con <code>uvicorn</code> (puertos 8770-8773).</li>
  <li>Crea <code>backend/.env</code> apuntando a <code>http://localhost:877x</code>.</li>
  <li>Instala dependencias y ejecuta:</li>
</ol>

<pre>cd backend
pip install -r requirements.txt
uvicorn main:app --host 0.0.0.0 --port 8000</pre>

<hr>

<footer>
  Hecho con ‚ù§Ô∏è para que lo arranques y pruebes en minutos.<br>
  ¬© 2025 Chat Multi-Agent Travel
</footer>

</body>
</html>
