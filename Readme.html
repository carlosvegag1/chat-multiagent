üöÄ Chat Multi-Agent Travel

Proyecto listo para ejecutar con **Docker** o en local.  
Incluye un **backend FastAPI**, un **frontend Next.js** y **4 micro-servicios MCP** (vuelos, hoteles, destinos y c√°lculo).

---

## üß© 1) Requisitos

- Windows / macOS / Linux con [Docker Desktop](https://www.docker.com/products/docker-desktop)  
- (Opcional) Claves reales:
  - `OPENAI_API_KEY`
  - `AMADEUS_API_KEY`
  - `AMADEUS_API_SECRET`
  - `WEATHER_API_KEY`

---

## ‚öôÔ∏è 2) Configura tus claves (opcional pero recomendado)

1. Copia `.env.example` a `.env` en la **ra√≠z** del proyecto.  
2. Rellena las variables que tengas:

   ```bash
   OPENAI_API_KEY=sk-...
   AMADEUS_API_KEY=...
   AMADEUS_API_SECRET=...
   WEATHER_API_KEY=...
   ```

El `docker-compose.yml` inyecta estas variables autom√°ticamente si existen,  
pero **no son obligatorias** para arrancar.

---

## üö¢ 3) Arranque s√∫per r√°pido

```bash
docker compose up -d --build
```

**Servicios expuestos:**

| Servicio     | URL |
|---------------|-----|
| Frontend | [http://127.0.0.1:3000](http://127.0.0.1:3000) |
| Backend (Swagger) | [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) |
| Calc | [8770](http://127.0.0.1:8770/docs) |
| Flights | [8771](http://127.0.0.1:8771/docs) |
| Hotels | [8772](http://127.0.0.1:8772/docs) |
| Destinations | [8773](http://127.0.0.1:8773/docs) |

---

## üß† 4) Pruebas de salud

**Esperado:** `HTTP/1.1 200 OK`

```bash
curl -I http://127.0.0.1:8770/docs
curl -I http://127.0.0.1:8771/docs
curl -I http://127.0.0.1:8772/docs
curl -I http://127.0.0.1:8773/docs
curl -I http://127.0.0.1:8000/docs
curl -I http://127.0.0.1:3000
```

---

## üí¨ 5) Probar el chat por API

Ejemplo (PowerShell en Windows):

```powershell
$body = @{
  user     = "Demo"
  message  = "Quiero un viaje de 2 d√≠as a Palma de Mallorca"
  convo_id = ""
} | ConvertTo-Json

curl.exe -s -X POST "http://127.0.0.1:8000/chat/" `
  -H "Content-Type: application/json" `
  --data-raw $body
```

---

## ü™µ 6) Ver logs

**√öltimas l√≠neas de todos los servicios:**

```bash
docker compose logs --tail=200
```

**Un servicio concreto:**

```bash
docker compose logs --tail=200 backend
docker compose logs --tail=200 flights
docker compose logs --tail=200 destinations
docker compose logs --tail=200 hotels
docker compose logs --tail=200 calc
docker compose logs --tail=200 frontend
```

**Seguimiento en vivo:**

```bash
docker compose logs -f backend
```

**Buscar errores comunes (Windows):**

```bash
docker compose logs backend | findstr /I "ERROR FALLBACK connect timeout refused"
```

---

## üß∞ 7) Problemas t√≠picos y soluci√≥n r√°pida

- ‚ùå **El backend intenta llamar a `127.0.0.1` desde Docker**
  - Este repo ya trae agentes con defaults a `flights:`, `destinations:`, `hotels:`.
  - Comprueba en logs del backend que veas mensajes como:
    ```
    DestinationAgent conectado a: http://destinations:8773
    FlightAgent conectado a: http://flights:8771
    ```

- ‚ö†Ô∏è **Aviso: `WEATHER_API_KEY` no definida**
  - Es opcional. Si quieres quitar el warning, a√±ade la clave en tu `.env`.

---

## üíª 8) Desarrollo local (sin Docker)

1. Levanta los MCPs individualmente con `uvicorn` (puertos 8770-8773).  
2. Crea `backend/.env` apuntando a `http://localhost:877x`.  
3. Instala dependencias y ejecuta:

   ```bash
   cd backend
   pip install -r requirements.txt
   uvicorn main:app --host 0.0.0.0 --port 8000
   ```

---

Hecho con ‚ù§Ô∏è para que lo arranques y pruebes en minutos.

---

### üìò Consejo adicional
> Si quieres que este README se vea perfecto en GitHub, gu√°rdalo como `README.md` en la ra√≠z del repositorio.  
> GitHub renderiza autom√°ticamente enlaces, tablas y bloques de c√≥digo como en este ejemplo.

